# Migration `20201025174311-initial-migration`

This migration has been generated by Stephen Jensen at 10/25/2020, 12:43:11 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Feed" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"url" text   NOT NULL ,
"authorId" text   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Bundle" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"description" text   NOT NULL DEFAULT E'',
"authorId" text   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."User" (
"id" text   NOT NULL ,
"auth0" text   NOT NULL ,
"nickname" text   ,
"picture" text   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."SavedArticle" (
"id" text   NOT NULL ,
"contents" jsonb   NOT NULL ,
"url" text   NOT NULL ,
"authorId" text   ,
"feedId" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."BundleTag" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."FeedTag" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_BundleToFeed" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_FeedToFeedTag" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_FeedUserLikes" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_BundleToBundleTag" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_BundleUserLikes" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE UNIQUE INDEX "Feed.url_unique" ON "public"."Feed"("url")

CREATE UNIQUE INDEX "User.auth0_unique" ON "public"."User"("auth0")

CREATE UNIQUE INDEX "SavedArticle.url_unique" ON "public"."SavedArticle"("url")

CREATE UNIQUE INDEX "BundleTag.name_unique" ON "public"."BundleTag"("name")

CREATE UNIQUE INDEX "FeedTag.name_unique" ON "public"."FeedTag"("name")

CREATE UNIQUE INDEX "_BundleToFeed_AB_unique" ON "public"."_BundleToFeed"("A", "B")

CREATE INDEX "_BundleToFeed_B_index" ON "public"."_BundleToFeed"("B")

CREATE UNIQUE INDEX "_FeedToFeedTag_AB_unique" ON "public"."_FeedToFeedTag"("A", "B")

CREATE INDEX "_FeedToFeedTag_B_index" ON "public"."_FeedToFeedTag"("B")

CREATE UNIQUE INDEX "_FeedUserLikes_AB_unique" ON "public"."_FeedUserLikes"("A", "B")

CREATE INDEX "_FeedUserLikes_B_index" ON "public"."_FeedUserLikes"("B")

CREATE UNIQUE INDEX "_BundleToBundleTag_AB_unique" ON "public"."_BundleToBundleTag"("A", "B")

CREATE INDEX "_BundleToBundleTag_B_index" ON "public"."_BundleToBundleTag"("B")

CREATE UNIQUE INDEX "_BundleUserLikes_AB_unique" ON "public"."_BundleUserLikes"("A", "B")

CREATE INDEX "_BundleUserLikes_B_index" ON "public"."_BundleUserLikes"("B")

ALTER TABLE "public"."Feed" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Bundle" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."SavedArticle" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."SavedArticle" ADD FOREIGN KEY ("feedId")REFERENCES "public"."Feed"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BundleToFeed" ADD FOREIGN KEY ("A")REFERENCES "public"."Bundle"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BundleToFeed" ADD FOREIGN KEY ("B")REFERENCES "public"."Feed"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FeedToFeedTag" ADD FOREIGN KEY ("A")REFERENCES "public"."Feed"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FeedToFeedTag" ADD FOREIGN KEY ("B")REFERENCES "public"."FeedTag"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FeedUserLikes" ADD FOREIGN KEY ("A")REFERENCES "public"."Feed"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FeedUserLikes" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BundleToBundleTag" ADD FOREIGN KEY ("A")REFERENCES "public"."Bundle"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BundleToBundleTag" ADD FOREIGN KEY ("B")REFERENCES "public"."BundleTag"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BundleUserLikes" ADD FOREIGN KEY ("A")REFERENCES "public"."Bundle"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BundleUserLikes" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201025174311-initial-migration
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,66 @@
+datasource db {
+  provider = "postgres"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model Feed {
+  id            String         @id 
+  name          String
+  url           String         @unique
+  bundles       Bundle[]
+  author        User?          @relation(name: "FeedAuthor", fields: [authorId], references: [id])
+  authorId      String?
+  tags          FeedTag[]
+  likes         User[]         @relation(name: "FeedUserLikes")
+  savedArticles SavedArticle[]
+}
+
+model Bundle {
+  id          String      @id
+  feeds       Feed[]
+  name        String
+  description String      @default("")
+  author      User?       @relation(name: "BundleAuthor", fields: [authorId], references: [id])
+  authorId    String?
+  tags        BundleTag[]
+  likes       User[]      @relation(name: "BundleUserLikes")
+}
+
+model User {
+  id            String         @id 
+  auth0         String         @unique
+  nickname      String?
+  picture       String?
+  bundles       Bundle[]       @relation("BundleAuthor")
+  feeds         Feed[]         @relation("FeedAuthor")
+  savedArticles SavedArticle[]
+  feedLikes     Feed[]         @relation(name: "FeedUserLikes")
+  bundleLikes   Bundle[]       @relation(name: "BundleUserLikes")
+
+}
+
+model SavedArticle {
+  id       String @id
+  author   User?  @relation(fields: [authorId], references: [id])
+  contents Json
+  url      String @unique
+  feed     Feed   @relation(fields: [feedId], references: [id])
+  authorId String?
+  feedId   String
+}
+
+model BundleTag {
+  id      String   @id
+  name    String   @unique
+  bundles Bundle[]
+}
+
+model FeedTag {
+  id    String @id
+  name  String @unique
+  feeds Feed[]
+}
```


